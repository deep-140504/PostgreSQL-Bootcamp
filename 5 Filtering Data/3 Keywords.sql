----------------------------------------------------------------------------------------------------
-- [1] Limit and Offset
SELECT
	*
FROM
	MOVIES;

SELECT
	*
FROM
	MOVIES
ORDER BY
	MOVIE_LENGTH DESC
LIMIT
	5;

SELECT
	*
FROM
	DIRECTORS
WHERE
	NATIONALITY = 'American'
ORDER BY
	DATE_OF_BIRTH
LIMIT
	5;

SELECT
	*
FROM
	ACTORS;

SELECT
	*
FROM
	ACTORS
WHERE
	GENDER = 'F'
ORDER BY
	DATE_OF_BIRTH DESC
LIMIT
	10;

SELECT
	*
FROM
	MOVIES_REVENUES;

SELECT
	*
FROM
	MOVIES_REVENUES
ORDER BY
	REVENUES_DOMESTIC DESC NULLS LAST
LIMIT
	10;

SELECT
	*
FROM
	MOVIES_REVENUES
ORDER BY
	REVENUES_DOMESTIC NULLS LAST
LIMIT
	10;

SELECT
	M.*,
	MR.REVENUES_DOMESTIC,
	MR.REVENUES_INTERNATIONAL
FROM
	MOVIES M
	JOIN MOVIES_REVENUES MR ON M.MOVIE_ID = MR.MOVIE_ID
ORDER BY
	MR.REVENUES_DOMESTIC NULLS LAST
LIMIT
	10;

SELECT
	*
FROM
	MOVIES
ORDER BY
	MOVIE_ID
LIMIT
	5
OFFSET
	5;

----------------------------------------------------------------------------------------------------
-- [2] Fetch
SELECT
	*
FROM
	MOVIES
FETCH FIRST
	5 ROWS ONLY;

SELECT
	*
FROM
	MOVIES
ORDER BY
	MOVIE_LENGTH DESC
FETCH FIRST
	5 ROWS ONLY;

SELECT
	*
FROM
	DIRECTORS
ORDER BY
	DATE_OF_BIRTH
FETCH FIRST
	5 ROWS ONLY;

SELECT
	*
FROM
	ACTORS
WHERE
	GENDER = 'F'
ORDER BY
	DATE_OF_BIRTH DESC
FETCH FIRST
	10 ROWS ONLY;

SELECT
	*
FROM
	MOVIES
ORDER BY
	MOVIE_LENGTH DESC
FETCH FIRST
	5 ROWS ONLY
OFFSET
	5;

----------------------------------------------------------------------------------------------------
-- [3] IN, NOT IN
SELECT
	*
FROM
	MOVIES
WHERE
	MOVIE_LANGUAGE IN ('English', 'Chinese', 'Japanese')
ORDER BY
	MOVIE_LANGUAGE;

SELECT
	*
FROM
	MOVIES
WHERE
	AGE_CERTIFICATE IN ('12', 'PG')
ORDER BY
	AGE_CERTIFICATE;

SELECT
	*
FROM
	MOVIES
WHERE
	DIRECTOR_ID NOT IN (13, 10)
ORDER BY
	DIRECTOR_ID;

SELECT
	*
FROM
	ACTORS
WHERE
	ACTOR_ID NOT IN (1, 2, 3, 4)
ORDER BY
	ACTOR_ID;

----------------------------------------------------------------------------------------------------
-- [4] between and not between
SELECT
	*
FROM
	ACTORS
WHERE
	DATE_OF_BIRTH BETWEEN '1991-01-01' AND '1995-12-31'
ORDER BY
	DATE_OF_BIRTH;

SELECT
	*
FROM
	MOVIES
WHERE
	RELEASE_DATE BETWEEN '1998-01-01' AND '2002-12-31'
ORDER BY
	RELEASE_DATE;

SELECT
	*
FROM
	MOVIES_REVENUES
WHERE
	REVENUES_DOMESTIC BETWEEN 102.10 AND 290.30
ORDER BY
	REVENUES_DOMESTIC NULLS LAST,
	REVENUES_INTERNATIONAL NULLS LAST;

SELECT
	*
FROM
	MOVIES
WHERE
	MOVIE_LENGTH NOT BETWEEN 100 AND 150
ORDER BY
	MOVIE_LENGTH;

SELECT
	*
FROM
	MOVIES
WHERE
	MOVIE_LENGTH >= 100
	AND MOVIE_LENGTH <= 150
ORDER BY
	MOVIE_LENGTH;

----------------------------------------------------------------------------------------------------
-- [5] like and ilike
-- % = 0 or more occurences
-- _exactly one occurence
SELECT
	'hello' LIKE 'hello';

SELECT
	'hello' LIKE 'h%';

SELECT
	'hello' LIKE '%e%';

SELECT
	'hello' LIKE 'hell%';

SELECT
	'hello' LIKE '%ll';

SELECT
	'hello' LIKE '_ello';

SELECT
	'hello' LIKE '__ll_'
SELECT
	'hello' LIKE '%l__';

SELECT
	*
FROM
	ACTORS
WHERE
	FIRST_NAME LIKE 'A%'
ORDER BY
	FIRST_NAME ASC;

SELECT
	*
FROM
	ACTORS
WHERE
	LAST_NAME LIKE '%a'
ORDER BY
	LAST_NAME ASC;

SELECT
	*
FROM
	ACTORS
WHERE
	FIRST_NAME LIKE '_____'
ORDER BY
	FIRST_NAME ASC;

SELECT
	*
FROM
	ACTORS
WHERE
	FIRST_NAME LIKE '_l%'
ORDER BY
	FIRST_NAME ASC;

SELECT
	*
FROM
	ACTORS
WHERE
	FIRST_NAME LIKE 'tim'
ORDER BY
	FIRST_NAME ASC;

/*
LIKE KEYWORD IS CASE-SENSITIVE
WHILE ILIKE KEYWORD IS NOT CASE-SENSITIVE
*/
SELECT
	*
FROM
	ACTORS
WHERE
	FIRST_NAME ILIKE 'tim'
ORDER BY
	FIRST_NAME ASC;

----------------------------------------------------------------------------------------------------
-- [6] IS NULL, IS NOT NULL
SELECT
	*
FROM
	ACTORS
WHERE
	DATE_OF_BIRTH IS NULL;

SELECT
	*
FROM
	ACTORS
WHERE
	DATE_OF_BIRTH IS NULL
	OR FIRST_NAME IS NULL;

SELECT
	M.*,
	MR.REVENUES_DOMESTIC
FROM
	MOVIES_REVENUES MR
	JOIN MOVIES M ON MR.MOVIE_ID = M.MOVIE_ID
WHERE
	REVENUES_DOMESTIC IS NULL;

SELECT
	*
FROM
	MOVIES_REVENUES
WHERE
	REVENUES_DOMESTIC IS NULL
	OR REVENUES_INTERNATIONAL IS NULL;

SELECT
	*
FROM
	MOVIES_REVENUES
WHERE
	REVENUES_DOMESTIC IS NOT NULL
	AND REVENUES_INTERNATIONAL IS NOT NULL;