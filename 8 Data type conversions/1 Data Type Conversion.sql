-- DATA TYPE CONVERSION
-- IMPLICIT CONVERSION
SELECT
	*
FROM
	MOVIES;

-- INTEGER = INTEGER
SELECT
	*
FROM
	MOVIES
WHERE
	MOVIE_ID = 1;

-- INTEGER = STRING
SELECT
	*
FROM
	MOVIES
WHERE
	MOVIE_ID = '1';

-- EXPLICIT CONVERSION
SELECT
	*
FROM
	MOVIES
WHERE
	MOVIE_ID = INTEGER '1';

SELECT
	CAST('10' AS INTEGER);

SELECT
	CAST('2020-01-01' AS DATE),
	CAST('01-JUL-2020' AS DATE);

SELECT
	DATE '2020-01-01';

SELECT
	CAST('true' AS BOOLEAN),
	CAST('false' AS BOOLEAN),
	CAST('T' AS BOOLEAN),
	CAST('F' AS BOOLEAN),
	CAST('0' AS BOOLEAN),
	CAST('y' AS BOOLEAN);

SELECT
	CAST('14.7678' AS REAL),
	CAST('14.7778' AS DOUBLE PRECISION);

-- :: OPERATOR
SELECT
	'10'::INTEGER,
	'2020-01-01'::DATE,
	'01-01-2020'::DATE;

SELECT
	'2020-02-20 10:30:26.467'::TIMESTAMP;

SELECT
	'2020-01-20 10:30:26.467'::TIMESTAMPTZ;

SELECT
	'10 minutes'::INTERVAL,
	'4 hours'::INTERVAL,
	'1 day'::INTERVAL,
	'2 weeks'::INTERVAL,
	'5 months'::INTERVAL;

-- IMPLICIT TO EXPLICIT CONVERSION
SELECT
	FACTORIAL(20);

SELECT
	FACTORIAL(20) AS "Factorial";

SELECT
	ROUND(10, 4) AS "Round";

SELECT
	ROUND(10, 4) AS "Round";

SELECT
	ROUND(CAST(10 AS NUMERIC), 4) AS "Round";

SELECT
	SUBSTR('123456', 2) AS "Sub String";

SELECT
	SUBSTR(CAST('123456' AS TEXT), 4) AS "Sub String";

-- TABLE DATA CONVERSION
CREATE TABLE RATING (
	RATING_ID SERIAL PRIMARY KEY,
	RATING VARCHAR(1) NOT NULL
);

INSERT INTO
	RATING (RATING)
VALUES
	('a'),
	('b'),
	('c'),
	('d');

SELECT
	*
FROM
	RATING;

INSERT INTO
	RATING (RATING)
VALUES
	(1),
	(2),
	(3),
	(4);

SELECT
	RATING_ID,
	CASE
		WHEN RATING ~ E'^\\d+$' THEN CAST(RATING AS INTEGER)
		ELSE 0
	END AS RATING
FROM
	RATING;